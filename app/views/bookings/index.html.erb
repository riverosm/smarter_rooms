<% if current_user.is_admin? %>
<div class="row">
  <div class="col">
    <div class="card">
      <h5 class="card-header">Today's bookings</h5>
      <div class="card-body centered">
        <% @bookings_today.each do |b| %>
        <b><%= b.room.name %></b> (<%= b.valid_from.strftime('%H:%M') %> - <%= b.valid_to.strftime('%H:%M') %>)
        <br />
        <%= b.user.name %> <br /> <br />
        <% end %>
      </div>
    </div>
  </div>
  <div class="col">
      <div class="card">
        <h5 class="card-header">Last bookings</h5>
        <div class="card-body centered">
            <% @bookings_lasts.each do |b| %>
            <b><%= b.created_at.to_s + " " + b.room.name %></b> (<%= b.valid_from.strftime('%H:%M') %> - <%= b.valid_to.strftime('%H:%M') %>)
            <br />
            <%= b.user.name %> <br /> <br />
            <% end %>
        </div>
      </div>
    </div>
  <div class="col">
      <div class="card">
        <h5 class="card-header">All bookings</h5>
        <div class="card-body centered">
          By Room <br />
          By Site <br />
          By Date <br />
        </div>
      </div>
    </div>
</div>


<% else %>

<% end %>

<div id="div_calendar_loading">
  <i class="fa fa-spinner fa-spin" style="font-size:24px"></i>
</div>

<div id="script-warning">
  bookings system must be running.
</div>

<div class="row justify-content-md-center mt-0">
  <div class="col-md-3">
    <h4 class="m-5">Filters:</h4>

<%= content_tag :div, class: "input-group m-5 row" do %>
<%= content_tag :div, class: "input-group-prepend" do %>
<%= content_tag :span, class: "input-group-text" do %>
<%= icon('fas', 'calendar-alt', class: 'fa-fw') %>
<% end %>
<% end %>
<select id="dates" name="dates" class="form-control" onchange="getBookings();">
  <option value="7">Next week</option>
  <option value="30">Next month</option>
  <option value="">All days</option>
</select>
<% end %>

<%= content_tag :div, class: "input-group m-5 row" do %>
<%= content_tag :div, class: "input-group-prepend" do %>
<%= content_tag :span, class: "input-group-text" do %>
<%= icon('fas', 'city', class: 'fa-fw') %>
<% end %>
<% end %>
<%= collection_select(:building, :id, Building.all, :id, :name, {:prompt=>"All buildings"}, {:class=>'form-control', :onchange=>'getBookings();'}) %>
<% end %>

<%= content_tag :div, class: "input-group m-5 row" do %>
<%= content_tag :div, class: "input-group-prepend" do %>
<%= content_tag :span, class: "input-group-text" do %>
<%= icon('fas', 'door-open', class: 'fa-fw') %>
<% end %>
<% end %>
<%= collection_select(:room, :id, Room.active.all, :id, :name, {:prompt=>"All rooms"}, {:class=>'form-control', :onchange=>'getBookings();'}) %>
<% end %>


  </div>
  <div class="col-md-9">
    <div id="calendar"></div>
  </div>
</div>

<%= render partial: "calendar_index_user", locals: {url: '/bookings.json?nocache=' + DateTime.now.to_i.to_s } %>